#include "ram.h"
#include <stdint.h>
#include <stdlib.h>

static byte sprites[80] = {
    0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
    0x20, 0x60, 0x20, 0x20, 0x70, // 1
    0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
    0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
    0x90, 0x90, 0xF0, 0x10, 0x10, // 4
    0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5 
    0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
    0xF0, 0x10, 0x20, 0x40, 0x40, // 7
    0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
    0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
    0xF0, 0x90, 0xF0, 0x90, 0x90, // A
    0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
    0xF0, 0x80, 0x80, 0x80, 0xF0, // C
    0xE0, 0x90, 0x90, 0x90, 0xE0, // D
    0xF0, 0x80, 0xF0, 0x80, 0xF0, // E 
    0xF0, 0x80, 0xF0, 0x80, 0x80  // F
};

Program* create_program() { 
    Program* ret = malloc(sizeof(Program));
    // Initialize vram
    for (int i = 0; i < CH8_SCREEN_HEIGHT; i++)
        ret->vram[i] = 0;

    // Initialize memory
    for (int i = 0; i < 80; i++) 
        ret->ram[i] = sprites[i]; // Default sprites
    for (int i = 80; i < CH8_MEMORY; i++)
        ret->ram[i] = 0; 
    for (int i = 0; i < CH8_REGISTERS; i++)
        ret->registers[i] = 0;
    for (int i = 0; i < CH8_STACK; i++)
        ret->stack[i] = 0;
    ret->I = 0;
    ret->dt = 0;
    ret->st = 0;
    ret->PC = CH8_START_INDEX;
    ret->stack_top = 0;

    return ret;
}

